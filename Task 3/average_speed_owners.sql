SELECT so.owners, AVG(se.dist_2h) avg_nautical_mile FROM ships_owners so, (SELECT ship, (AVG(speed))*2 as dist_2h from position_data WHERE timestamps::time >= '12:00:00' and timestamps::time <= '14:00:00' GROUP BY ship) se WHERE se.ship = so.ship_id GROUP BY so.owners;